import os,sys
import numpy as np
import unittest

import deepmd.op
from deepmd.env import tf
from deepmd.env import op_module
from deepmd.env import GLOBAL_TF_FLOAT_PRECISION
from deepmd.env import GLOBAL_NP_FLOAT_PRECISION
from deepmd.env import GLOBAL_ENER_FLOAT_PRECISION

def qr(x, nbit):
        return np.round(x * 2**nbit) / (2**nbit)

def qf(x, nbit):
        return np.floor(x * 2**nbit) / (2**nbit)


class TestNvnmdMapOp(tf.test.TestCase):
    def setUp(self):
        config = tf.ConfigProto()
        if int(os.environ.get("DP_AUTO_PARALLELIZATION", 0)):
            config.graph_options.rewrite_options.custom_optimizers.add().name = "dpparallel"
        self.sess = self.test_session(config=config).__enter__()
        self.nbit_x  = 14
        self.nbit_xk = 10
        self.nbit_yk = 10
        self.prec_x =  1/2**self.nbit_x
        self.prec_xk = 1/2**self.nbit_xk
        self.prec_yk = 1/2**self.nbit_yk 

    def gen_map_table(self):
        n = 2**self.nbit_xk
        #
        t = np.arange(n+1) / n
        v = np.power(t, 3)
        dv = 3 * np.power(t, 2)
        dv2 = 6 * np.power(t, 1)
        self.v = qr(v, self.nbit_yk).reshape([-1, 1])
        self.dv = qr(dv, self.nbit_yk).reshape([-1, 1])
        self.dv2 = qr(dv2, self.nbit_yk).reshape([-1, 1])
    
    def map_nvnmd_py(self, x, v, d_v, dv, d_dv, prec_xk, nbit_yk):
        pv = []
        for ii in range(len(x)):
            # y = vk + dvk * dxk
            k = np.int32(np.floor(x[ii] / prec_xk))
            xk = k * prec_xk
            dxk = x[ii] - xk
            vk = v[k]
            dvk = d_v[k]
            pvi = vk + dvk*dxk
            pv.append(pvi)
        pv = np.array(pv).reshape([-1, 1])
        return pv

    def test_map_op(self):
        self.gen_map_table()
        x =  qr(np.random.rand(100)*0.9, self.nbit_x).reshape([-1, 1])
        y = self.map_nvnmd_py(x, self.v, self.dv, self.dv, self.dv2, self.prec_xk, self.nbit_yk)
        ty = op_module.map_nvnmd(x, self.v, self.dv, self.dv, self.dv2, self.prec_xk, self.nbit_yk)
        self.sess.run(tf.global_variables_initializer())
        typ = self.sess.run(ty)
        np.testing.assert_almost_equal(typ, y, 5)

class TestNvnmdMatmulOp(tf.test.TestCase):
    def setUp(self):
        config = tf.ConfigProto()
        if int(os.environ.get("DP_AUTO_PARALLELIZATION", 0)):
            config.graph_options.rewrite_options.custom_optimizers.add().name = "dpparallel"
        self.sess = self.test_session(config=config).__enter__()
        self.nbit = 13

    def nvnmd_matmul_py(self, x, w, is_round, nbit, nbit2, nbit3):
        if nbit < 0:
            return np.matmul(x, w)
        else:
            if is_round == 1:
                return qr(np.matmul(x, w), nbit)
            else:
                return qf(np.matmul(x, w), nbit)
    
    def test_nvnmd_matmul(self):
        N = 10
        M = 10
        K = 10
        x = np.random.rand(N, M)
        w = np.random.rand(M, K)
        x = qr(x, self.nbit)
        w = qr(x, self.nbit)
        y = self.nvnmd_matmul_py(x, w, 1, self.nbit, self.nbit, -1)
        ty = op_module.matmul_nvnmd(x, w, 1, self.nbit, self.nbit, -1)
        self.sess.run (tf.global_variables_initializer())
        typ = self.sess.run(ty)
        np.testing.assert_almost_equal(typ, y, 5)


class TestNvnmdQuantizeOp(tf.test.TestCase):
    def setUp(self):
        config = tf.ConfigProto()
        if int(os.environ.get("DP_AUTO_PARALLELIZATION", 0)):
            config.graph_options.rewrite_options.custom_optimizers.add().name = "dpparallel"
        self.sess = self.test_session(config=config).__enter__()
        self.nbit = 13
    
    def nvnmd_quantize_py(self, x, is_round, nbit, nbit2, nbit3):
        if nbit < 0:
            return x
        else:
            if is_round == 1:
                return qr(x, nbit)
            else:
                return qf(x, nbit)
    
    def test_nvnmd_quantize(self):
        N = 10
        M = 10
        x = np.random.rand(N, M)
        y = self.nvnmd_quantize_py(x, 1, self.nbit, self.nbit, -1)
        ty = op_module.quantize_nvnmd(x, 1, self.nbit, self.nbit, -1)
        self.sess.run (tf.global_variables_initializer())
        typ = self.sess.run(ty)
        np.testing.assert_almost_equal(typ, y, 5)

class TestNvnmdTanh2Op(tf.test.TestCase):
    def setUp(self):
        config = tf.ConfigProto()
        if int(os.environ.get("DP_AUTO_PARALLELIZATION", 0)):
            config.graph_options.rewrite_options.custom_optimizers.add().name = "dpparallel"
        self.sess = self.test_session(config=config).__enter__()
        self.nbit = 13
    
    def nvnmd_tanh2_py(self, x, is_round, nbit, nbit2, nbit3):
        if nbit < 0:
            x1 = np.clip(x, -2, 2)
            x2 = np.clip(x, -4, 4)
            x1a = np.abs(x1)
            x2a = np.abs(x2)
            y1 = x1a - x1a * x1a * 0.25
            y2 = x2a * 0.03125 - x2a * x2a * 0.00390625
            y = y1 + y2
            y = y * np.sign(x1)
        else:
            if is_round:
                x = qr(x, nbit)
                x1 = np.clip(x, -2, 2)
                x2 = np.clip(x, -4, 4)
                x1a = np.abs(x1)
                x2a = np.abs(x2)
                y1 = x1a - x1a * x1a * 0.25
                y2 = x2a * 0.03125 - x2a * x2a * 0.00390625
                y = qr(y1, nbit) + qr(y2, nbit)
                y = y * np.sign(x1)
            else:
                x = qf(x, nbit)
                x1 = np.clip(x, -2, 2)
                x2 = np.clip(x, -4, 4)
                x1a = np.abs(x1)
                x2a = np.abs(x2)
                y1 = x1a - x1a * x1a * 0.25
                y2 = x2a * 0.03125 - x2a * x2a * 0.00390625
                y = qf(y1, nbit) + qf(y2, nbit)
                y = y * np.sign(x1)
        return y

    def test_nvnmd_tanh2(self):
        N = 10
        M = 10
        x = np.random.rand(N, M)
        y = self.nvnmd_tanh2_py(x, 1, self.nbit, self.nbit, -1)
        ty = op_module.tanh2_nvnmd(x, 1, self.nbit, self.nbit, -1)
        self.sess.run (tf.global_variables_initializer())
        typ = self.sess.run(ty)
        np.testing.assert_almost_equal(typ, y, 5)

class TestNvnmdTanh4Op(tf.test.TestCase):
    def setUp(self):
        config = tf.ConfigProto()
        if int(os.environ.get("DP_AUTO_PARALLELIZATION", 0)):
            config.graph_options.rewrite_options.custom_optimizers.add().name = "dpparallel"
        self.sess = self.test_session(config=config).__enter__()
        self.nbit = 13

    def nvnmd_tanh4_py(self, x, is_round, nbit, nbit2, nbit3):
        if nbit < 0:
            x = np.clip(x, -2, 2)
            xa = np.abs(x)
            xx = x * x
            y = xx * (xx * 0.0625 - xa * 0.25) + xa 
            y = y * np.sign(x)
            return y
        else:
            if is_round:
                x = np.clip(x, -2, 2)
                xa = np.abs(x)
                xx = qr(x * x, nbit)
                y = xx * (xx * 0.0625 - xa * 0.25) + xa
                y = qr(y, nbit)
                y = y * np.sign(x)
                return y
            else:
                x = np.clip(x, -2, 2)
                xa = np.abs(x)
                xx = qf(x * x, nbit)
                y = xx * (xx * 0.0625 - xa * 0.25) + xa 
                y = qf(y, nbit)
                y = y * np.sign(x)
                return y

    def test_nvnmd_tanh4(self):
        N = 10
        M = 10
        x = np.random.rand(N, M)
        y = self.nvnmd_tanh4_py(x, 1, self.nbit, self.nbit, -1)
        ty = op_module.tanh4_nvnmd(x, 1, self.nbit, self.nbit, -1)
        self.sess.run(tf.global_variables_initializer())
        typ = self.sess.run(ty)
        np.testing.assert_almost_equal(typ, y, 5)


class TestProdEnvMatANvnmdQuantize(tf.test.TestCase):
    def setUp(self):
        config = tf.ConfigProto()
        if int(os.environ.get("DP_AUTO_PARALLELIZATION", 0)):
            config.graph_options.rewrite_options.custom_optimizers.add().name = "dpparallel"
        self.sess = self.test_session(config=config).__enter__() 

    def prod_env_mat_a_nvnmd_quantize_py(self):
        coord = [
        0.000000, 0.000000, 0.000010,
        0.000000, 3.004288, 3.004288,
        3.004288, 0.000000, 3.004288,
        3.004288, 3.004288, 0.000000,
        0.000000, 0.000000, 3.004288,
        3.004288, 0.000000, 0.000000,
        0.000000, 3.004288, 0.000000,
        3.004288, 3.004288, 3.004288]
        coord = np.reshape(np.array(coord), [1, -1])
        #
        atype = [
            0, 0, 0, 0, 
            1, 1, 1, 1]
        atype = np.reshape(np.array(atype), [1, -1])
        #
        box = [
            6.0085759, 0., 0.,
            0., 6.0085759, 0.,
            0., 0., 6.0085759]
        box = np.reshape(np.array(box), [1, -1])
        #
        natoms = [8, 8, 4, 4]
        natoms = np.int32(np.array(natoms))
        #
        mesh = np.int32(np.array([0, 0, 0, 2, 2, 2]))
        t_avg = np.zeros([2, 64*4])
        t_std = np.ones([2, 64*4])
        #
        y = [
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938,
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,  -3.004272460938,  -3.004272460938,  -0.000000000000, 
        18.051269531250,  -3.004272460938,   3.004272460938,  -0.000000000000, 
        18.051269531250,   3.004272460938,  -3.004272460938,  -0.000000000000, 
        18.051269531250,   3.004272460938,   3.004272460938,  -0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        9.025634765625,  -3.004272460938,   0.000000000000,  -0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,  -0.000000000000, 
        9.025634765625,   3.004272460938,   0.000000000000,  -0.000000000000, 
        9.025634765625,   0.000000000000,   3.004272460938,  -0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,   3.004272460938, 
        9.025634765625,   0.000000000000,   3.004272460938,   0.000000000000, 
        9.025634765625,   3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,  -3.004272460938,   0.000000000000,   0.000000000000, 
        9.025634765625,   0.000000000000,  -3.004272460938,   0.000000000000, 
        9.025634765625,   0.000000000000,   0.000000000000,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,  -3.004272460938, 
        27.076904296875,   3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,   3.004272460938,   3.004272460938, 
        27.076904296875,   3.004272460938,  -3.004272460938,   3.004272460938, 
        27.076904296875,  -3.004272460938,  -3.004272460938,   3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,   3.004272460938, 
        18.051269531250,   3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,   3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,   3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,   3.004272460938, 
        18.051269531250,  -3.004272460938,   3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,   3.004272460938,  -3.004272460938, 
        18.051269531250,   3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   3.004272460938,   0.000000000000,  -3.004272460938, 
        18.051269531250,  -3.004272460938,  -3.004272460938,   0.000000000000, 
        18.051269531250,   0.000000000000,  -3.004272460938,  -3.004272460938, 
        18.051269531250,  -3.004272460938,   0.000000000000,  -3.004272460938, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000, 
        0.000000000000,   0.000000000000,   0.000000000000,   0.000000000000]
        y = np.array(y).reshape([1, -1])
        return coord, atype, natoms, box, mesh, t_avg, t_std, y

    def test_prod_env_mat_a_nvnmd_quantize(self):
        coord, atype, natoms, box, mesh, t_avg, t_std, y = self.prod_env_mat_a_nvnmd_quantize_py()
        ty, tdy, trij, tnlist = op_module.prod_env_mat_a_nvnmd_quantize(
            coord,
            atype,
            natoms,
            box,
            mesh,
            t_avg,
            t_std,
            rcut_a = 0,
            rcut_r = 6.0,
            rcut_r_smth = 0.5,
            sel_a = [32, 32],
            sel_r = [0, 0]
        )
        self.sess.run(tf.global_variables_initializer())
        typ = self.sess.run(ty)
        np.testing.assert_almost_equal(typ, y, 5)


if __name__ == '__main__':
    unittest.main()
